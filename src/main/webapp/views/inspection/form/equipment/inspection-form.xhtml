<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:o="http://omnifaces.org/ui" xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="head">
        <h:outputStylesheet library="#{appSetting.resourceLib}"
                            name="css/material-theme.css"></h:outputStylesheet>
        <!-- إضافة خطوط Google Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Poppins:wght@400;500;600;700&amp;family=Playfair+Display:wght@400;500;600;700&amp;display=swap" rel="stylesheet" />
        <style>
            /* update on branch review */
            :root {
                --gold-50: #fffbf0;
                --gold-100: #fef7e0;
                --gold-200: #fef0c7;
                --gold-300: #fedf89;
                --gold-400: #fec84b;
                --gold-500: #fdb414;
                --gold-600: #dc9200;
                --gold-700: #b26d00;
                --gold-800: #925a00;
                --gold-900: #783f00;

                --primary-50: var(--gold-50);
                --primary-100: var(--gold-100);
                --primary-200: var(--gold-200);
                --primary-300: var(--gold-300);
                --primary-400: var(--gold-400);
                --primary-500: var(--gold-500);
                --primary-600: var(--gold-600);
                --primary-700: var(--gold-700);
                --primary-800: var(--gold-800);
                --primary-900: var(--gold-900);

                --secondary-50: #fefce8;
                --secondary-100: #fef9c3;
                --secondary-200: #fef08a;
                --secondary-300: #fde047;
                --secondary-400: #facc15;
                --secondary-500: #eab308;
                --secondary-600: #ca8a04;
                --secondary-700: #a16207;
                --secondary-800: #854d0e;
                --secondary-900: #713f12;

                --accent-50: #fef3c7;
                --accent-100: #fde68a;
                --accent-200: #fcd34d;
                --accent-300: #fbbf24;
                --accent-400: #f59e0b;
                --accent-500: #d97706;
                --accent-600: #b45309;
                --accent-700: #92400e;
                --accent-800: #78350f;
                --accent-900: #451a03;

                --success-50: #ecfdf5;
                --success-100: #d1fae5;
                --success-200: #a7f3d0;
                --success-300: #6ee7b7;
                --success-400: #34d399;
                --success-500: #10b981;
                --success-600: #059669;
                --success-700: #047857;
                --success-800: #065f46;
                --success-900: #064e3b;

                --warning-50: #fffbeb;
                --warning-100: #fef3c7;
                --warning-200: #fde68a;
                --warning-300: #fcd34d;
                --warning-400: #fbbf24;
                --warning-500: #f59e0b;
                --warning-600: #d97706;
                --warning-700: #b45309;
                --warning-800: #92400e;
                --warning-900: #78350f;

                --danger-50: #fef2f2;
                --danger-100: #fee2e2;
                --danger-200: #fecaca;
                --danger-300: #fca5a5;
                --danger-400: #f87171;
                --danger-500: #ef4444;
                --danger-600: #dc2626;
                --danger-700: #b91c1c;
                --danger-800: #991b1b;
                --danger-900: #7f1d1d;

                --info-50: #f0f9ff;
                --info-100: #e0f2fe;
                --info-200: #bae6fd;
                --info-300: #7dd3fc;
                --info-400: #38bdf8;
                --info-500: #0ea5e9;
                --info-600: #0284c7;
                --info-700: #0369a1;
                --info-800: #075985;
                --info-900: #0c4a6e;

                --surface-0: #ffffff;
                --surface-50: #fffdf7;
                --surface-100: #fffbf0;
                --surface-200: #fef7e0;
                --surface-300: #fef0c7;
                --surface-400: #fedf89;
                --surface-500: #fdb414;
                --surface-600: #dc9200;
                --surface-700: #b26d00;
                --surface-800: #925a00;
                --surface-900: #783f00;
                --surface-950: #451a03;

                --shadow-sm: 0 1px 3px rgba(120, 63, 0, 0.08);
                --shadow: 0 1px 3px rgba(120, 63, 0, 0.1), 0 1px 2px rgba(120, 63, 0, 0.06);
                --shadow-md: 0 4px 12px rgba(120, 63, 0, 0.12);
                --shadow-lg: 0 10px 25px rgba(120, 63, 0, 0.15);
                --shadow-xl: 0 20px 40px rgba(120, 63, 0, 0.18);
                --shadow-2xl: 0 25px 50px -12px rgba(120, 63, 0, 0.25);
                --shadow-inner: inset 0 2px 4px 0 rgba(120, 63, 0, 0.06);
                --glass-shadow: 0 8px 32px 0 rgba(120, 63, 0, 0.15);
                --golden-glow: 0 0 20px rgba(253, 180, 20, 0.4);

                --radius-sm: 8px;
                --radius: 12px;
                --radius-md: 14px;
                --radius-lg: 16px;
                --radius-xl: 20px;
                --radius-2xl: 24px;
                --radius-3xl: 32px;
                --radius-full: 9999px;

                --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);

                --gradient-primary: linear-gradient(135deg, var(--gold-500) 0%, var(--gold-700) 100%);
                --gradient-premium: linear-gradient(135deg, #fdb414 0%, #dc9200 50%, #b26d00 100%);
                --gradient-gold: linear-gradient(135deg, #fdb414 0%, #b26d00 100%);
                --gradient-accent: linear-gradient(135deg, var(--accent-500), var(--accent-700));
                --gradient-danger: linear-gradient(135deg, var(--danger-500), var(--danger-700));
                --gradient-warning: linear-gradient(135deg, var(--warning-500), var(--warning-700));
                --gradient-success: linear-gradient(135deg, var(--success-500), var(--success-700));
                --gradient-card: linear-gradient(135deg, rgba(255, 253, 248, 0.96) 0%, rgba(255, 252, 242, 0.98) 100%);
            }

            /* تحسينات الخطوط والمظهر العام */
            body {
                background-color: #fefaf0 !important;
                background-image:
                        radial-gradient(at 40% 20%, rgba(254, 244, 215, 0.7) 0px, transparent 50%),
                        radial-gradient(at 80% 0%, rgba(254, 247, 224, 0.5) 0px, transparent 50%),
                        radial-gradient(at 0% 50%, rgba(255, 251, 240, 0.6) 0px, transparent 50%),
                        radial-gradient(at 80% 50%, rgba(254, 240, 199, 0.4) 0px, transparent 50%);
                color: var(--surface-800);
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                line-height: 1.6;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                font-size: 0.9375rem;
            }

            /* تحسين تنسيق النصوص والعناوين */
            h1, h2, h3, h4, h5, h6 {
                font-family: 'Playfair Display', 'Poppins', serif;
                font-weight: 600;
                line-height: 1.3;
                margin-bottom: 1rem;
            }

            /* Premium Card Styling with Golden Glassmorphism */
            .card {
                background: var(--gradient-card);
                border-radius: var(--radius-xl);
                box-shadow: var(--shadow-lg), var(--glass-shadow);
                border: 1px solid rgba(255, 248, 225, 0.3);
                backdrop-filter: blur(12px);
                position: relative;
                overflow: hidden;
                margin-bottom: 2rem;
                transform: translateY(0);
                animation: cardSlideIn 0.6s ease-out forwards;
                transition: var(--transition-slow);
                padding: 2rem;
                border-top: 4px solid var(--gold-500);
            }

            .card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 6px;
                background: var(--gradient-premium);
                z-index: 1;
            }

            @keyframes cardSlideIn {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .card:hover {
                transform: translateY(-8px);
                box-shadow: var(--shadow-xl), var(--golden-glow), 0 8px 25px rgba(253, 180, 20, 0.25);
            }

            /* Typography with Golden Headings */
            .smat-label {
                font-weight: 600;
                color: var(--gold-800);
                font-size: 0.875rem;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                margin-bottom: 0.5rem;
                display: block;
                font-family: 'Poppins', sans-serif;
            }

            h3.smat-label {
                font-size: 1.85rem;
                font-weight: 700;
                background: var(--gradient-premium);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                text-transform: none;
                letter-spacing: -0.025em;
                margin-bottom: 1.5rem;
                line-height: 1.2;
                padding-bottom: 0.75rem;
                border-bottom: 2px solid var(--gold-200);
                font-family: 'Playfair Display', serif;
                position: relative;
            }

            h3.smat-label:after {
                content: "";
                position: absolute;
                bottom: -2px;
                left: 0;
                width: 80px;
                height: 3px;
                background: var(--gradient-gold);
                border-radius: 3px;
            }

            /* Premium Form Elements with Golden Focus States */
            .ui-inputtext,
            .ui-selectonemenu,
            .ui-inputtextarea,
            .ui-calendar {
                border: 2px solid rgba(220, 200, 167, 0.4);
                border-radius: var(--radius-md);
                padding: 0.85rem 1rem;
                font-size: 0.9375rem;
                background: rgba(255, 255, 255, 0.85);
                transition: var(--transition);
                box-shadow: var(--shadow-sm);
                width: 100%;
                color: var(--surface-800);
                font-family: 'Inter', sans-serif;
            }

            .ui-inputtext:focus,
            .ui-selectonemenu:focus,
            .ui-inputtextarea:focus,
            .ui-calendar:focus {
                outline: none;
                border-color: var(--gold-500);
                box-shadow: 0 0 0 3px var(--gold-100), var(--shadow-md), var(--golden-glow);
                background-color: var(--gold-50);
                transform: translateY(-2px);
            }

            .ui-inputtext:hover,
            .ui-selectonemenu:hover,
            .ui-inputtextarea:hover,
            .ui-calendar:hover {
                border-color: var(--gold-400);
                background-color: var(--surface-50);
                box-shadow: var(--shadow-sm), 0 0 0 1px rgba(253, 180, 20, 0.2);
            }

            .input-text-smat-background {
                background: var(--surface-50);
                border-color: var(--surface-300);
                box-shadow: var(--shadow-inner);
            }

            /* Golden SelectOneMenu */
            .ui-selectonemenu {
                appearance: none;
                background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23fdb414'%3e%3cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3e%3c/svg%3e");
                background-repeat: no-repeat;
                background-position: right 0.75rem center;
                background-size: 1.25rem;
                padding-right: 2.5rem;
            }

            /* Golden Checkbox Styling */
            body .ui-chkbox .ui-chkbox-box {
                width: 1.25rem;
                height: 1.25rem;
                border: 2px solid var(--gold-300);
                border-radius: var(--radius-sm);
                background: var(--surface-0);
                transition: var(--transition);
                position: relative;
            }

            body .ui-chkbox .ui-chkbox-box.ui-state-active {
                background: var(--gradient-gold);
                border-color: var(--gold-500);
                box-shadow: 0 0 0 2px var(--gold-100);
            }

            body .ui-chkbox .ui-chkbox-box.ui-state-active .ui-chkbox-icon {
                color: white;
            }

            body .ui-chkbox .ui-chkbox-box.ui-state-focus {
                box-shadow: 0 0 0 3px var(--gold-100);
                border-color: var(--gold-500);
            }

            /* Panel Grid - Premium Table with Golden Header */
            .ui-panelgrid .custom-panel-grid {
                width: 100%;
                border-collapse: separate;
                border-spacing: 0;
                border-radius: var(--radius-xl);
                overflow: hidden;
                box-shadow: var(--shadow-lg);
                background: var(--surface-0);
                border: 1px solid rgba(255, 248, 225, 0.3);
            }

            .ui-panelgrid .custom-panel-grid tr td {
                padding: 1rem;
                border: 1px solid var(--gold-100);
                background: var(--surface-0);
                transition: var(--transition);
                font-family: 'Inter', sans-serif;
            }

            .ui-panelgrid .custom-panel-grid tr:hover td {
                background: var(--surface-50);
            }

            .ui-panelgrid .custom-panel-grid thead tr {
                background: var(--gradient-premium);
                color: white;
            }

            .ui-panelgrid .custom-panel-grid thead tr td {
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                padding: 1.25rem 1.5rem;
                border-color: var(--gold-600);
                text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
                font-family: 'Poppins', sans-serif;
                font-size: 0.9rem;
            }

            /* Premium Golden Buttons with Hover Effects */
            .ui-button {
                border-radius: var(--radius-full);
                font-weight: 600;
                letter-spacing: 0.05em;
                padding: 0.75rem 1.75rem;
                position: relative;
                overflow: hidden;
                transition: var(--transition-slow);
                box-shadow: var(--shadow);
                border: none;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                gap: 0.6rem;
                font-size: 0.9rem;
                min-width: 140px;
                height: 44px;
                font-family: 'Poppins', sans-serif;
            }

            .ui-button::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 5px;
                height: 5px;
                background: rgba(255, 255, 255, 0.5);
                opacity: 0;
                border-radius: 100%;
                transform: scale(1, 1) translate(-50%);
                transform-origin: 50% 50%;
            }

            .ui-button:hover::after {
                animation: ripple 1s ease-out;
            }

            @keyframes ripple {
                0% {
                    transform: scale(0, 0);
                    opacity: 0.5;
                }
                100% {
                    transform: scale(20, 20);
                    opacity: 0;
                }
            }

            .ui-button:hover {
                transform: translateY(-4px) scale(1.02);
                box-shadow: var(--shadow-lg), var(--golden-glow);
            }

            .ui-button:active {
                transform: translateY(0);
                box-shadow: var(--shadow-md);
            }

            .ui-button-danger {
                background: var(--gradient-danger) !important;
                color: white !important;
            }

            .ui-button-warning {
                background: var(--gradient-warning) !important;
                color: white !important;
            }

            .ui-button-success {
                background: var(--gradient-success) !important;
                color: white !important;
            }

            .ui-button-help {
                background: var(--gradient-premium) !important;
                color: white !important;
            }

            .ui-button-info {
                background: var(--gradient-accent) !important;
                color: white !important;
            }

            /* Action Buttons Container */
            .action-buttons {
                display: flex;
                gap: 1rem;
                flex-wrap: wrap;
                justify-content: flex-start;
                margin-top: 2rem;
                padding-top: 1.5rem;
                border-top: 1px solid rgba(220, 200, 167, 0.3);
            }

            /* Responsive adjustments for buttons */
            @media (max-width: 768px) {
                .action-buttons {
                    flex-direction: column;
                    gap: 0.75rem;
                }

                .ui-button {
                    width: 100%;
                    margin-bottom: 0;
                }
            }

            /* Golden Chip Styling */
            .ui-chip {
                background: linear-gradient(90deg, var(--gold-100), var(--accent-100));
                color: var(--gold-800);
                border-radius: var(--radius-full);
                padding: 0.6rem 1.2rem;
                box-shadow: var(--shadow-sm);
                transition: var(--transition);
                display: inline-flex;
                align-items: center;
                font-weight: 500;
                border: 1px solid var(--gold-200);
                font-family: 'Inter', sans-serif;
                backdrop-filter: blur(8px);
            }

            .ui-chip:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow);
                background: linear-gradient(90deg, var(--gold-200), var(--accent-200));
            }

            .ui-chip-icon {
                margin-right: 0.5rem;
                color: var(--gold-600);
            }

            /* Signature Styling with Golden Border */
            .ui-signature {
                border: 2px dashed var(--gold-200);
                border-radius: var(--radius-lg);
                background: var(--surface-50);
                transition: var(--transition);
                background-image:
                        linear-gradient(to right, var(--gold-50) 1px, transparent 1px),
                        linear-gradient(to bottom, var(--gold-50) 1px, transparent 1px);
                background-size: 20px 20px;
                backdrop-filter: blur(4px);
            }

            .ui-signature:hover {
                border-color: var(--gold-400);
                background-color: var(--gold-50);
                box-shadow: var(--golden-glow);
            }

            /* Golden Divider Styling */
            .ui-divider {
                margin: 2rem 0;
                border: none;
                height: 1px;
                background: linear-gradient(90deg, transparent, var(--gold-400), transparent);
                opacity: 0.5;
            }

            .ui-divider-solid {
                background: var(--gold-300);
            }

            /* Field Group Styling with Golden Accent */
            .field {
                margin-bottom: 1.5rem;
                position: relative;
                padding-left: 1.5rem;
            }

            .field::before {
                content: '';
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 4px;
                background: var(--gradient-gold);
                border-radius: var(--radius-full);
                opacity: 0.8;
                transition: var(--transition);
            }

            .field:focus-within::before {
                opacity: 1;
                width: 6px;
            }

            /* Premium Dialog Styling */
            .ui-dialog {
                border-radius: var(--radius-2xl);
                box-shadow: var(--shadow-2xl), var(--glass-shadow);
                border: 1px solid rgba(255, 248, 225, 0.3);
                overflow: hidden;
                border-top: 4px solid var(--gold-500);
                backdrop-filter: blur(12px);
                background: rgba(255, 253, 248, 0.95);
            }

            .ui-dialog .ui-dialog-titlebar {
                background: var(--gradient-premium);
                color: white;
                border-radius: 0;
                padding: 1.25rem 1.5rem;
                font-weight: 600;
                text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
                font-family: 'Poppins', sans-serif;
            }

            .ui-dialog .ui-dialog-content {
                padding: 1.5rem;
                background: transparent;
            }

            /* Premium Growl Notifications */
            .ui-growl {
                top: 25px;
                right: 25px;
            }

            .ui-growl-item-container {
                border-radius: var(--radius-lg);
                box-shadow: var(--shadow-xl), var(--glass-shadow);
                overflow: hidden;
                border-left: 4px solid var(--gold-500);
                backdrop-filter: blur(10px);
                background: rgba(255, 253, 248, 0.95);
                border: 1px solid rgba(255, 248, 225, 0.3);
            }

            .ui-growl-message {
                padding: 1rem;
                font-family: 'Inter', sans-serif;
            }

            .ui-growl-icon-close {
                top: 0.5rem;
                right: 0.5rem;
            }

            /* Status Dialog with Golden Animation */
            .pi-spinner {
                animation: spin 1s linear infinite;
                color: var(--gold-500);
                filter: drop-shadow(0 0 2px rgba(253, 180, 20, 0.5));
            }

            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }

            /* Additional Premium Elements */
            .pe\:documentViewer {
                border-radius: var(--radius-lg);
                overflow: hidden;
                box-shadow: var(--shadow);
                border: 1px solid var(--gold-200);
            }

            /* Hover effects for all interactive elements */
            a, button, .ui-button, .ui-selectonemenu,
            .ui-inputtext, .ui-inputtextarea, .ui-chkbox {
                transition: var(--transition);
            }

            /* Responsive adjustments */
            @media (max-width: 768px) {
                .card {
                    margin: 1rem;
                    border-radius: var(--radius-lg);
                    padding: 1.5rem;
                }

                .ui-inputtext, .ui-selectonemenu, .ui-inputtextarea {
                    font-size: 1rem;
                    padding: 1rem;
                }

                .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4,
                .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8,
                .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12,
                .col-xl-1, .col-xl-2, .col-xl-3, .col-xl-4,
                .col-xl-5, .col-xl-6, .col-xl-7, .col-xl-8,
                .col-xl-9, .col-xl-10, .col-xl-11, .col-xl-12,
                .col-xxl-1, .col-xxl-2, .col-xxl-3, .col-xxl-4,
                .col-xxl-5, .col-xxl-6, .col-xxl-7, .col-xxl-8,
                .col-xxl-9, .col-xxl-10, .col-xxl-11, .col-xxl-12 {
                    flex: 0 0 100%;
                    max-width: 100%;
                }
            }

            /* Button Size Variants */
            .btn-sm {
                padding: 0.65rem 1.5rem !important;
                font-size: 0.85rem !important;
                min-width: 120px !important;
                height: 38px !important;
            }

            .action-buttons {
                display: flex;
                gap: 0.75rem;
                flex-wrap: wrap;
                justify-content: flex-start;
                margin-top: 1.5rem;
                padding-top: 1rem;
                border-top: 1px solid rgba(220, 200, 167, 0.3);
            }

            /* Extra Small Button Styles */
            .btn-xs {
                padding: 0.5rem 1rem !important;
                font-size: 0.75rem !important;
                min-width: 90px !important;
                border-radius: 20px !important;
                height: 32px !important;
            }

            /* Compact action buttons container */
            .action-buttons-compact {
                display: flex;
                gap: 0.6rem;
                flex-wrap: wrap;
                justify-content: flex-end;
                margin-top: 1.5rem;
                padding-top: 1rem;
                border-top: 1px solid rgba(220, 200, 167, 0.3);
                width: 100%;
            }

            /* Make icons slightly smaller in xs buttons */
            .btn-xs .ui-icon {
                font-size: 0.75rem !important;
            }

            .rounded-btn {
                border-radius: 24px !important;
                padding: 0.5rem 1.2rem !important;
                font-size: 0.85rem !important;
                min-width: 100px;
                height: 36px;
            }

            /* Premium Golden Button Styles */
            .btn-golden-primary {
                background: var(--gradient-premium) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 12px rgba(253, 180, 20, 0.3) !important;
            }

            .btn-golden-orange {
                background: linear-gradient(135deg, #f59e0b, #d97706) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3) !important;
            }

            .btn-golden-blue {
                background: linear-gradient(135deg, #0ea5e9, #0369a1) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3) !important;
            }

            .btn-golden-red {
                background: linear-gradient(135deg, #ef4444, #b91c1c) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;
            }

            /* Hover Effects for Golden Buttons */
            .btn-golden-primary:hover {
                background: linear-gradient(135deg, #dc9200, #b26d00) !important;
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(253, 180, 20, 0.4), var(--golden-glow) !important;
            }

            .btn-golden-orange:hover {
                background: linear-gradient(135deg, #d97706, #b45309) !important;
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4) !important;
            }

            .btn-golden-blue:hover {
                background: linear-gradient(135deg, #0284c7, #075985) !important;
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(14, 165, 233, 0.4) !important;
            }

            .btn-golden-red:hover {
                background: linear-gradient(135deg, #dc2626, #991b1b) !important;
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4) !important;
            }

            /* Active/Pressed State */
            .btn-golden-primary:active,
            .btn-golden-orange:active,
            .btn-golden-blue:active,
            .btn-golden-red:active {
                transform: translateY(0) scale(1) !important;
                box-shadow: 0 2px 8px rgba(120, 63, 0, 0.2) !important;
            }

            /* Disabled State */
            .btn-golden-primary.ui-state-disabled,
            .btn-golden-orange.ui-state-disabled,
            .btn-golden-blue.ui-state-disabled,
            .btn-golden-red.ui-state-disabled {
                opacity: 0.6 !important;
                background: var(--gold-300) !important;
                color: var(--gold-600) !important;
                box-shadow: none !important;
                transform: none !important;
            }

            /* علامات الحقول الإجبارية */
            .field-required .smat-label::after {
                content: " *";
                color: var(--danger-500);
                font-weight: bold;
                margin-left: 2px;
            }

            .field-required .smat-label {
                position: relative;
            }

            .field-required .smat-label::before {
                content: "";
                position: absolute;
                left: -16px;
                top: 50%;
                transform: translateY(-50%);
                width: 8px;
                height: 8px;
                background-color: var(--danger-500);
                border-radius: 50%;
                animation: pulse 2s infinite;
                box-shadow: 0 0 0 2px rgba(217, 119, 110, 0.4);
            }

            @keyframes pulse {
                0% {
                    transform: translateY(-50%) scale(1);
                    opacity: 1;
                }
                50% {
                    transform: translateY(-50%) scale(1.2);
                    opacity: 0.7;
                }
                100% {
                    transform: translateY(-50%) scale(1);
                    opacity: 1;
                }
            }

            /* تحسين مظهر الحقول الإجبارية */
            .field-required .ui-inputtext,
            .field-required .ui-selectonemenu,
            .field-required .ui-inputtextarea,
            .field-required .ui-calendar {
                border-left: 3px solid var(--danger-300) !important;
                background-color: var(--danger-50) !important;
            }

            .field-required .ui-inputtext:focus,
            .field-required .ui-selectonemenu:focus,
            .field-required .ui-inputtextarea:focus,
            .field-required .ui-calendar:focus {
                border-color: var(--danger-500) !important;
                box-shadow: 0 0 0 3px var(--danger-100), var(--shadow-md) !important;
            }

            /* تحسينات إضافية للخطوط */
            p, span, div, td, li {
                font-family: 'Inter', sans-serif;
                letter-spacing: -0.01em;
            }

            strong, b {
                font-weight: 600;
            }

            /* تحسين التباعد بين العناصر */
            .row {
                margin-bottom: 0.5rem;
            }

            /* تحسين مظهر الأيقونات */
            .pi {
                font-size: 1.1em;
            }

            /* تحسين مظهر الرسائل */
            .ui-message {
                font-family: 'Inter', sans-serif;
                font-size: 0.875rem;
                margin-top: 0.25rem;
            }

            /* تحسين مظهر التبويبات إذا وجدت */
            .ui-tabs .ui-tabs-nav li {
                font-family: 'Poppins', sans-serif;
                font-weight: 500;
            }

            /* تحسين مظهر القوائم المنسدلة */
            .ui-selectonemenu-items {
                font-family: 'Inter', sans-serif;
            }

            /* تحسين مظهر عناصر الواجهة الصغيرة */
            small, .small-text {
                font-size: 0.8125rem;
                font-family: 'Inter', sans-serif;
            }

            /* Custom Scrollbar */
            ::-webkit-scrollbar {
                width: 10px;
                height: 10px;
            }

            ::-webkit-scrollbar-track {
                background: rgba(220, 200, 167, 0.1);
                border-radius: 10px;
            }

            ::-webkit-scrollbar-thumb {
                background: linear-gradient(to bottom, var(--gold-400), var(--gold-600));
                border-radius: 10px;
            }

            ::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(to bottom, var(--gold-500), var(--gold-700));
            }

            /* Premium Section Headers */
            .section-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 2rem;
                padding-bottom: 1rem;
                border-bottom: 1px solid rgba(220, 200, 167, 0.3);
                position: relative;
            }

            .section-header:after {
                content: "";
                position: absolute;
                bottom: -1px;
                left: 0;
                width: 100px;
                height: 2px;
                background: var(--gradient-gold);
                border-radius: 2px;
            }

            /* Premium Template Scroll Container - إضافة خاصية التمرير الأفقي للقالب */
            .template-scroll-container {
                overflow-x: auto;
                overflow-y: hidden;
                width: 100%;
                border: 1px solid rgba(220, 200, 167, 0.3);
                border-radius: var(--radius-lg);
                margin-top: 1.5rem;
                padding: 1rem;
                background: linear-gradient(135deg, rgba(255, 253, 248, 0.95) 0%, rgba(255, 252, 242, 0.98) 100%);
                box-shadow: var(--shadow-md), var(--glass-shadow);
                backdrop-filter: blur(8px);
                position: relative;
            }

            .template-scroll-content {
                min-width: 100%;
                width: auto;
                white-space: nowrap;
                padding: 0.5rem;
            }

            .scroll-indicator {
                text-align: center;
                color: var(--gold-600);
                font-size: 0.8rem;
                margin-top: 0.5rem;
                font-style: italic;
                font-family: 'Poppins', sans-serif;
                background: linear-gradient(90deg, transparent, var(--gold-100), transparent);
                padding: 0.5rem;
                border-radius: var(--radius-full);
                border: 1px dashed var(--gold-200);
            }

            .scroll-indicator i {
                color: var(--gold-500);
                margin: 0 0.5rem;
                animation: bounce 2s infinite;
            }

            @keyframes bounce {
                0%, 100% { transform: translateX(0); }
                50% { transform: translateX(5px); }
            }

            /* تحسين مظهر الجدول داخل حاوية التمرير */
            .template-scroll-container .custom-panel-grid {
                margin-bottom: 0;
                box-shadow: none;
                border: 1px solid rgba(220, 200, 167, 0.2);
            }

            .template-scroll-container .custom-panel-grid tr td {
                white-space: nowrap;
                min-width: 120px;
            }

            /* تأثيرات تفاعلية لحاوية التمرير */
            .template-scroll-container:hover {
                box-shadow: var(--shadow-lg), 0 0 20px rgba(253, 180, 20, 0.1);
                border-color: var(--gold-300);
            }

            /* شريط التمرير المخصص للحاوية */
            .template-scroll-container::-webkit-scrollbar {
                height: 8px;
            }

            .template-scroll-container::-webkit-scrollbar-track {
                background: rgba(220, 200, 167, 0.1);
                border-radius: 4px;
            }

            .template-scroll-container::-webkit-scrollbar-thumb {
                background: linear-gradient(90deg, var(--gold-400), var(--gold-600));
                border-radius: 4px;
                border: 1px solid rgba(255, 248, 225, 0.3);
            }

            .template-scroll-container::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(90deg, var(--gold-500), var(--gold-700));
            }
            /* إجبار العرض المطلوب، متوافق مع PrimeFaces */
            .smat-select-short.ui-selectonemenu {
                width: 140px !important;      /* غيّر 140px حسب حاجتك (مثلاً 160px أو 200px) */
                min-width: 140px !important;
                max-width: none !important;
                display: inline-block;
                box-sizing: border-box;
                vertical-align: middle;
            }

            /* تأكد أن الليبل يستخدم كامل المساحة ولا يقطعها محدد آخر */
            .smat-select-short .ui-selectonemenu-label,
            .smat-select-short .ui-selectonemenu-label .ui-selectonemenu-value {
                display: inline-block;
                width: calc(100% - 1.5rem);   /* يحجز مكان للسهم */
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            /* responsive: على الموبايل يرجع يعرض كامل العمود */
            @media (max-width: 768px) {
                .smat-select-short.ui-selectonemenu {
                    width: 100% !important;
                    min-width: 0 !important;
                }
            }

            /* إضافة تصميم جديد لأزرار Draft Management */
            .draft-management-section {
                background: linear-gradient(135deg, rgba(255, 251, 240, 0.95) 0%, rgba(254, 247, 224, 0.98) 100%);
                border-radius: var(--radius-xl);
                border: 1px solid rgba(253, 180, 20, 0.3);
                box-shadow: var(--shadow-md), 0 0 15px rgba(253, 180, 20, 0.1);
                padding: 1.5rem;
                margin-bottom: 2rem;
                position: relative;
                overflow: hidden;
                transition: var(--transition);
            }

            .draft-management-section::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 4px;
                background: var(--gradient-premium);
                z-index: 1;
            }

            .draft-management-section:hover {
                box-shadow: var(--shadow-lg), 0 0 20px rgba(253, 180, 20, 0.15);
                transform: translateY(-2px);
            }

            .draft-management-header {
                display: flex;
                align-items: center;
                margin-bottom: 1rem;
                padding-bottom: 0.75rem;
                border-bottom: 1px solid rgba(253, 180, 20, 0.2);
            }

            .draft-management-header i {
                color: var(--gold-500);
                font-size: 1.5rem;
                margin-right: 0.75rem;
                filter: drop-shadow(0 0 3px rgba(253, 180, 20, 0.5));
            }

            .draft-management-header h4 {
                color: var(--gold-800);
                margin: 0;
                font-family: 'Playfair Display', serif;
                font-weight: 600;
                background: var(--gradient-premium);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            .draft-buttons-container {
                display: flex;
                gap: 1rem;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap;
            }

            .draft-button {
                position: relative;
                overflow: hidden;
                border-radius: var(--radius-full);
                font-weight: 600;
                letter-spacing: 0.05em;
                padding: 0.85rem 2rem;
                min-width: 160px;
                height: 48px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                gap: 0.75rem;
                font-family: 'Poppins', sans-serif;
                font-size: 0.95rem;
                transition: var(--transition-slow);
                box-shadow: 0 4px 12px rgba(253, 180, 20, 0.25);
                border: none;
            }

            .draft-button::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
                transition: var(--transition-slow);
            }

            .draft-button:hover::before {
                left: 100%;
            }

            .draft-button-save {
                background: var(--gradient-premium) !important;
                color: white !important;
            }

            .draft-button-load {
                background: linear-gradient(135deg, #0ea5e9, #0369a1) !important;
                color: white !important;
            }

            .draft-button:hover {
                transform: translateY(-3px) scale(1.05);
                box-shadow: 0 6px 20px rgba(253, 180, 20, 0.4), var(--golden-glow);
            }

            .draft-button:active {
                transform: translateY(0) scale(1);
                box-shadow: 0 2px 8px rgba(253, 180, 20, 0.3);
            }

            .draft-description {
                text-align: center;
                margin-top: 1rem;
                color: var(--gold-700);
                font-size: 0.875rem;
                font-style: italic;
                font-family: 'Inter', sans-serif;
            }

            /* تأثير التوهج الذهبي للحقول */
            .golden-glow {
                animation: goldenGlowEffect 2s ease-in-out;
            }

            @keyframes goldenGlowEffect {
                0% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    border-color: rgba(253, 180, 20, 0.5);
                }
                25% {
                    box-shadow: 0 0 20px rgba(253, 180, 20, 0.6), 0 0 30px rgba(253, 180, 20, 0.4);
                    border-color: var(--gold-400);
                    transform: scale(1.01);
                }
                50% {
                    box-shadow: 0 0 25px rgba(253, 180, 20, 0.8), 0 0 40px rgba(253, 180, 20, 0.6);
                    border-color: var(--gold-500);
                    transform: scale(1.02);
                }
                75% {
                    box-shadow: 0 0 20px rgba(253, 180, 20, 0.6), 0 0 30px rgba(253, 180, 20, 0.4);
                    border-color: var(--gold-400);
                    transform: scale(1.01);
                }
                100% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    border-color: rgba(253, 180, 20, 0.5);
                    transform: scale(1);
                }
            }

            /* Responsive adjustments for draft section */
            @media (max-width: 768px) {
                .draft-management-section {
                    padding: 1.25rem;
                    margin: 1rem 0;
                }

                .draft-buttons-container {
                    flex-direction: column;
                    gap: 0.75rem;
                }

                .draft-button {
                    width: 100%;
                    min-width: auto;
                }
            }
            /* حواف دائرية أكثر أناقة للأزرار */
            .draft-button-rounded {
                border-radius: 25px !important;
                padding: 0.85rem 2rem !important;
                min-width: 160px !important;
                height: 48px !important;
            }

            /* تحسين تأثير التوهج */
            .golden-glow {
                animation: goldenGlowEffect 1s ease-in-out !important;
                border-color: var(--gold-400) !important;
            }

            @keyframes goldenGlowEffect {
                0% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 20px rgba(253, 180, 20, 0.6), 0 0 30px rgba(253, 180, 20, 0.4);
                    transform: scale(1.02);
                }
                100% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    transform: scale(1);
                }
            }

            /* تحسين مظهر أزرار الـ Draft */
            .draft-button-rounded.draft-button-save {
                background: var(--gradient-premium) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 15px rgba(253, 180, 20, 0.3) !important;
            }

            .draft-button-rounded.draft-button-load {
                background: linear-gradient(135deg, #0ea5e9, #0369a1) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 15px rgba(14, 165, 233, 0.3) !important;
            }

            .draft-button-rounded:hover {
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(253, 180, 20, 0.4) !important;
            }
            /* حواف دائرية أكثر أناقة للأزرار */
            .draft-button-rounded {
                border-radius: 25px !important;
                padding: 0.85rem 2rem !important;
                min-width: 160px !important;
                height: 48px !important;
            }

            /* تحسين تأثير التوهج */
            .golden-glow {
                animation: goldenGlowEffect 1s ease-in-out !important;
                border-color: var(--gold-400) !important;
            }

            @keyframes goldenGlowEffect {
                0% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 20px rgba(253, 180, 20, 0.6), 0 0 30px rgba(253, 180, 20, 0.4);
                    transform: scale(1.02);
                }
                100% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    transform: scale(1);
                }
            }


            /* تحسين مظهر أزرار الـ Draft */
            .draft-button-rounded.draft-button-save {
                background: var(--gradient-premium) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 15px rgba(253, 180, 20, 0.3) !important;
            }

            .draft-button-rounded.draft-button-load {
                background: linear-gradient(135deg, #0ea5e9, #0369a1) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 15px rgba(14, 165, 233, 0.3) !important;
            }

            .draft-button-rounded:hover {
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(253, 180, 20, 0.4) !important;
            }

            /* مؤشر التحميل */
            .loading-indicator {
                background: rgba(255, 253, 248, 0.95);
                border-radius: var(--radius-lg);
                border: 1px solid var(--gold-200);
                box-shadow: var(--shadow-md);
                margin: 1rem 0;
                animation: fadeIn 0.3s ease;
            }

            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }

            /* رسالة نجاح حفظ المسودة */
            .draft-success-message {
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--gradient-success);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: var(--radius-lg);
                box-shadow: var(--shadow-xl), 0 5px 20px rgba(16, 185, 129, 0.4);
                z-index: 10000;
                transform: translateX(400px);
                opacity: 0;
                transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                min-width: 280px;
            }

            .draft-success-message.show {
                transform: translateX(0);
                opacity: 1;
            }

            .draft-success-message .message-content {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                font-family: 'Poppins', sans-serif;
                font-weight: 600;
                font-size: 0.95rem;
            }

            .draft-success-message .pi-check-circle {
                font-size: 1.4rem;
                color: rgba(255, 255, 255, 0.9);
                filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
            }

            /* حواف دائرية أكثر أناقة للأزرار */
            .draft-button-rounded {
                border-radius: 25px !important;
                padding: 0.85rem 2rem !important;
                min-width: 160px !important;
                height: 48px !important;
            }

            /* تحسين تأثير التوهج */
            .golden-glow {
                animation: goldenGlowEffect 1s ease-in-out !important;
                border-color: var(--gold-400) !important;
            }

            @keyframes goldenGlowEffect {
                0% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 20px rgba(253, 180, 20, 0.6), 0 0 30px rgba(253, 180, 20, 0.4);
                    transform: scale(1.02);
                }
                100% {
                    box-shadow: 0 0 5px rgba(253, 180, 20, 0.3);
                    transform: scale(1);
                }
            }

            /* تحسين مظهر أزرار الـ Draft */
            .draft-button-rounded.draft-button-save {
                background: var(--gradient-premium) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 15px rgba(253, 180, 20, 0.3) !important;
            }

            .draft-button-rounded.draft-button-load {
                background: linear-gradient(135deg, #0ea5e9, #0369a1) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 4px 15px rgba(14, 165, 233, 0.3) !important;
            }

            .draft-button-rounded:hover {
                transform: translateY(-3px) scale(1.05) !important;
                box-shadow: 0 6px 20px rgba(253, 180, 20, 0.4) !important;
            }

            /* مؤشر التحميل */
            .loading-indicator {
                background: rgba(255, 253, 248, 0.95);
                border-radius: var(--radius-lg);
                border: 1px solid var(--gold-200);
                box-shadow: var(--shadow-md);
                margin: 1rem 0;
                animation: fadeIn 0.3s ease;
            }

            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }

            /* تأثير اهتزاز بسيط للرسالة */
            @keyframes gentleBounce {
                0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
                40% {transform: translateY(-5px);}
                60% {transform: translateY(-3px);}
            }

            .draft-success-message.show {
                transform: translateX(0);
                opacity: 1;
                animation: gentleBounce 0.6s ease;
            }

        </style>

    </ui:define>
    <ui:define name="section-content">
        <h:form id="form">
            <!-- قسم إدارة المسودات الجديد -->
            <div class="draft-management-section">
                <div class="draft-management-header">
                    <i class="pi pi-cloud-upload"></i>
                    <h4>Draft Management</h4>
                </div>
                <div class="draft-buttons-container">
                    <!-- زر Save Draft مع تصميم جديد -->
                    <p:commandButton value="Save Draft" icon="pi pi-save"
                                     type="button"
                                     onclick="handleSaveDraft();"
                                     styleClass="draft-button-rounded draft-button-save"
                                     rendered="#{inspectionFormBean.inspectorVisible}" />

                    <!-- زر Load Draft مع تصميم جديد وتأثير التوهج -->
                    <p:commandButton value="Load Draft" icon="pi pi-download"
                                     action="#{inspectionFormBean.loadDraft()}"
                                     update="@form" process="@this"
                                     styleClass="draft-button-rounded draft-button-load"
                                     onstart="showLoadingIndicator();"
                                     oncomplete="setTimeout(triggerGoldenGlow, 1000);"
                                     rendered="#{inspectionFormBean.inspectorVisible}" />
                </div>

                <!-- رسالة نجاح حفظ المسودة -->
                <div id="draftSavedMessage" class="draft-success-message" style="display: none;">
                    <div class="message-content">
                        <i class="pi pi-check-circle"></i>
                        <span>Draft Saved Successfully!</span>
                    </div>
                </div>

                <p:outputPanel rendered="#{inspectionFormBean.inspectorVisible}">
                    <p class="draft-description">
                        Save your progress or load a previously saved draft to continue working
                    </p>
                </p:outputPanel>
            </div>

            <!-- مؤشر التحميل -->
            <p:outputPanel id="loadingIndicator" style="display:none; text-align: center; padding: 1rem;" styleClass="loading-indicator">
                <i class="pi pi-spin pi-spinner" style="font-size: 2rem; color: var(--gold-500);"></i>
                <p style="margin-top: 0.5rem; color: var(--gold-600);">Loading draft, please wait...</p>
            </p:outputPanel>

            <!-- remoteCommand to set savingDraft flag on the server BEFORE the real submit -->
            <p:remoteCommand name="markSavingDraft" actionListener="#{inspectionFormBean.prepareSaveDraft}" process="@this" oncomplete="document.getElementById('form:saveDraftInvoker').click();" />
            <!-- hidden real submit invoked after markSavingDraft completes -->
            <p:commandButton id="saveDraftInvoker" style="display:none" action="#{inspectionFormBean.saveDraft()}" process="@form" update="@([id$=messages])" />

            <script>
                // دالة جديدة للتعامل مع حفظ المسودة
                function handleSaveDraft() {
                    // تشغيل عملية الحفظ الأصلية
                    markSavingDraft();

                    // إظهار رسالة النجاح بعد 0.5 ثانية
                    setTimeout(showSuccessMessage, 500);
                }

                // دالة لإظهار رسالة النجاح
                function showSuccessMessage() {
                    const message = document.getElementById('draftSavedMessage');
                    if (message) {
                        message.style.display = 'block';

                        // إضافة تأثير الظهور
                        setTimeout(() => {
                            message.classList.add('show');
                        }, 10);

                        // إخفاء الرسالة بعد 3 ثوانٍ
                        setTimeout(() => {
                            message.classList.remove('show');
                            setTimeout(() => {
                                message.style.display = 'none';
                            }, 500);
                        }, 3000);
                    }
                }

                // دالة لإظهار مؤشر التحميل
                function showLoadingIndicator() {
                    const indicator = document.querySelector('.loading-indicator');
                    if (indicator) {
                        indicator.style.display = 'block';
                    }
                }

                // دالة محسنة لتأثير التوهج الذهبي مع تأخير
                function triggerGoldenGlow() {
                    console.log('loading draft');

                    // إخفاء مؤشر التحميل
                    const indicator = document.querySelector('.loading-indicator');
                    if (indicator) {
                        indicator.style.display = 'none';
                    }

                    // تحديد جميع الحقول في النموذج
                    const formElements = document.querySelectorAll('#form input, #form textarea, #form select, #form .ui-inputtext, #form .ui-selectonemenu, #form .ui-inputtextarea, #form .ui-calendar, #form .ui-chkbox-box');

                    console.log('تم العثور على ' + formElements.length + ' عنصر');

                    // إضافة تأثير التوهج لكل حقل
                    formElements.forEach((element, index) => {
                        setTimeout(() => {
                            element.classList.add('golden-glow');

                            // إزالة التأثير بعد انتهاء الرسوم المتحركة
                            setTimeout(() => {
                                element.classList.remove('golden-glow');
                            }, 1000);
                        }, index * 30); // تأثير متتالي للحقول
                    });

                    // إضافة تأثير خاص للبطاقة الرئيسية
                    const mainCard = document.querySelector('.card');
                    if (mainCard) {
                        mainCard.style.transition = 'all 0.5s ease';
                        mainCard.style.boxShadow = '0 0 30px rgba(253, 180, 20, 0.4), var(--shadow-xl)';
                        setTimeout(() => {
                            mainCard.style.boxShadow = '';
                        }, 1000);
                    }

                    // تأثير للنص التوضيحي
                    const draftSection = document.querySelector('.draft-management-section');
                    if (draftSection) {
                        draftSection.style.transition = 'all 0.5s ease';
                        draftSection.style.boxShadow = '0 0 25px rgba(14, 165, 233, 0.4)';
                        setTimeout(() => {
                            draftSection.style.boxShadow = '';
                        }, 1000);
                    }
                }

                // التأكد من تحميل DOM
                document.addEventListener('DOMContentLoaded', function() {
                    console.log('draft loaded successfully');
                });
            </script>
            <!-- Main Form Card -->
            <div class="card">
                <div class="section-header">
                    <h3 class="smat-label">#{inspectionFormBean.formTemplate.title}</h3>
                    <p:badge value="INSPECTION FORM" severity="info" styleClass="badge-lg" />
                </div>

                <!-- Comment Section -->
                <div class="row">
                    <div class="col-lg-12 col-xl-12 col-xxl-12">
                        <div class="field">
                            <h:outputText value="#{interfaceLabel.comment}" styleClass="smat-label" />
                            <div class="ui-chip">
                                <span class="ui-chip-icon pi pi-comment"></span>
                                <div class="ui-chip-text"
                                     style="text-overflow: ellipsis; overflow: hidden; white-space: nowrap; padding: 4px; max-width: 250px; width: auto;"
                                     title="#{inspectionFormBean.stepComment}">#{inspectionFormBean.stepComment}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <p:divider layout="horizontal" type="solid" styleClass="mt-4 mb-4" />

                <!-- Basic Information Section -->
                <div class="row">
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field">
                            <h:outputText value="#{interfaceLabel.reportNo}" styleClass="smat-label" />
                            <p:inputText
                                    value="#{inspectionFormBean.equipmentInspectionForm.reportNo}"
                                    disabled="true" styleClass="block input-text-smat-background" />
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field">
                            <h:outputText value="#{interfaceLabel.timeSheetNo}" styleClass="smat-label" />
                            <p:inputText
                                    value="#{inspectionFormBean.equipmentInspectionForm.timeSheetNo}"
                                    styleClass="block input-text-smat-background" />
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field">
                            <h:outputText value="#{interfaceLabel.jobNo}" styleClass="smat-label" />
                            <p:inputText
                                    value="#{inspectionFormBean.equipmentInspectionForm.jobNo}"
                                    styleClass="block input-text-smat-background" />
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.stickerNo}" styleClass="smat-label" />
                            <p:inputText rendered="#{inspectionFormBean.disabled or inspectionFormBean.disableSticker}"
                                         value="#{inspectionFormBean.equipmentInspectionForm.stickerNo}"
                                         disabled="true" styleClass="block input-text-smat-background" />
                            <p:selectOneMenu id="selectoneMenu_sticker"
                                             style="width:100%;" filter="true" filterMatchMode="contains"
                                             widgetVar="widgetVarSticker" rendered="#{!inspectionFormBean.disabled and !inspectionFormBean.disableSticker}"
                                             converter="omnifaces.SelectItemsIndexConverter"
                                             value="#{inspectionFormBean.equipmentInspectionForm.sticker}">
                                <f:selectItem itemLabel="Select sticker:" value="#{null}" noSelectionOption="false" />
                                <f:selectItems
                                        itemLabel="#{stickerVar.stickerNo}"
                                        itemValue="#{stickerVar}" var="stickerVar"
                                        value="#{inspectionFormBean.stickers}" />
                            </p:selectOneMenu>
                        </div>
                    </div>
                </div>

                <!-- Dates Section -->
                <div class="row">
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.dateOfThoroughExamination}" styleClass="smat-label" />
                            <p:calendar disabled="#{inspectionFormBean.disabled}"
                                        value="#{inspectionFormBean.equipmentInspectionForm.dateOfThoroughExamination}"
                                        styleClass="block" showIcon="true" />
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.nextExaminationDate}" styleClass="smat-label" />
                            <p:calendar disabled="#{inspectionFormBean.disabled}"
                                        value="#{inspectionFormBean.equipmentInspectionForm.nextExaminationDate}"
                                        styleClass="block" showIcon="true" />
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-3 col-xxl-3">
                        <div class="field">
                            <h:outputText value="#{interfaceLabel.previousExaminationDate}" styleClass="smat-label" />
                            <p:calendar disabled="#{inspectionFormBean.disabled}"
                                        value="#{inspectionFormBean.equipmentInspectionForm.previousExaminationDate}"
                                        styleClass="block" showIcon="true" />
                        </div>
                    </div>
                </div>

                <!-- Company Information - Modified to include address next to company -->
                <div class="row">
                    <div class="col-lg-6 col-xl-6 col-xxl-6">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.company}" styleClass="smat-label" />
                            <p:selectOneMenu disabled="#{inspectionFormBean.disabled}"
                                             style="width:100%;"
                                             value="#{inspectionFormBean.equipmentInspectionForm.company}"
                                             converter="omnifaces.SelectItemsIndexConverter">
                                <f:selectItem itemLabel="#{interfaceLabel.choose}" itemValue="" />
                                <f:selectItems itemLabel="#{companyVar.name} "
                                               itemValue="#{companyVar}" var="companyVar"
                                               value="#{inspectionFormBean.companies}" />
                                <p:ajax update="@([id$=companyAddress])" />
                            </p:selectOneMenu>
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-6 col-xxl-6">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.nameAndAddressOfEmployer}" styleClass="smat-label" />
                            <p:inputTextarea id="companyAddress"
                                             disabled="#{inspectionFormBean.disabled}"
                                             value="#{inspectionFormBean.equipmentInspectionForm.company.address}"
                                             styleClass="block" rows="2" />
                        </div>
                    </div>
                </div>

                <!-- Examination and Equipment Type -->
                <div class="row">
                    <div class="col-lg-6 col-xl-6 col-xxl-6">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.examinationType}" styleClass="smat-label" />
                            <p:selectOneMenu disabled="#{inspectionFormBean.disabled}"
                                             style="width:100%;"
                                             value="#{inspectionFormBean.examinationType}"
                                             converter="omnifaces.SelectItemsIndexConverter">
                                <f:selectItems itemLabel="#{examinationType.englishName} "
                                               itemValue="#{examinationType}" var="examinationType"
                                               value="#{inspectionFormBean.examinationTypes}" />
                            </p:selectOneMenu>
                        </div>
                    </div>
                    <div class="col-lg-6 col-xl-6 col-xxl-6">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.equipmentType}" styleClass="smat-label" />
                            <p:selectOneMenu disabled="#{inspectionFormBean.disabled}"
                                             style="width:100%;"
                                             value="#{inspectionFormBean.equipmentType}"
                                             converter="omnifaces.SelectItemsIndexConverter">
                                <f:selectItems itemLabel="#{equipmentType.englishName} "
                                               itemValue="#{equipmentType}" var="equipmentType"
                                               value="#{inspectionFormBean.equipmentTypes}" />
                            </p:selectOneMenu>
                        </div>
                    </div>
                </div>
            </div>

            <p:divider layout="horizontal" type="solid" styleClass="mt-4 mb-4" />

            <!-- Dynamic Content Panel with Horizontal Scroll -->
            <div class="card">
                <div class="section-header">
                    <h4 style="color: var(--gold-800); margin: 0; font-family: 'Playfair Display', serif;">
                        <i class="pi pi-table" style="margin-right: 10px;"></i>
                        #{inspectionFormBean.formTemplate.title} - Details
                    </h4>
                </div>

                <!-- إضافة حاوية التمرير الأفقي للقالب -->
                <div class="template-scroll-container">
                    <div class="template-scroll-content">
                        <p:panelGrid id="panelGridDaynamicContent" styleClass="custom-panel-grid" layout="tabular" columns="0">
                            <f:facet name="header">
                                <p:row>
                                    <p:column colspan="12" style="text-align: center; font-weight: 700; font-size: 1.1rem;">
                                        <i class="pi pi-list" style="margin-right: 8px;"></i>
                                        Inspection Details
                                    </p:column>
                                </p:row>
                            </f:facet>
                            <ui:repeat value="#{inspectionFormBean.formRows}" var="formRow">
                                <p:row>
                                    <ui:repeat
                                            value="#{inspectionFormBean.getFormColumnsPerRow(formRow)}"
                                            var="formColumn">
                                        <p:column colspan="#{formColumn.colSpan}"
                                                  rowspan="#{formColumn.rowSpan}" style="#{formColumn.style}"
                                                  styleClass="#{formColumn.styleClass}">
                                            <ui:repeat
                                                    value="#{inspectionFormBean.getColumnContentByColumn(formColumn)}"
                                                    var="columnContent">

                                                <p:outputLabel style="margin-left:2px;margin-right:2px;"
                                                               rendered="#{columnContent.generalEquipmentItem.itemType.code eq '01'}"
                                                               value="#{columnContent.generalEquipmentItem.itemText}" />

                                                <p:inputText style="margin-left:2px;margin-right:2px;"
                                                             rendered="#{columnContent.generalEquipmentItem.itemType.code eq '02'}"
                                                             value="#{columnContent.contentValue}" />


                                                <p:selectBooleanCheckbox value="#{columnContent.contentValue}"
                                                                         style="margin-left:2px;margin-right:2px;"
                                                                         rendered="#{columnContent.generalEquipmentItem.itemType.code eq '03'}" />

                                                <p:selectOneMenu
                                                        rendered="#{columnContent.generalEquipmentItem.itemType.code eq '04'}"
                                                        style="margin-left:2px;margin-right:2px;" dynamic="true"
                                                        immediate="true" value="#{columnContent.contentValue}"
                                                        styleClass="smat-select-short">

                                                    <f:selectItems
                                                            itemLabel="#{checklistDetailDataSource.itemValue} "
                                                            itemValue="#{checklistDetailDataSource.itemValue}"
                                                            var="checklistDetailDataSource"
                                                            value="#{inspectionFormBean.getBy(columnContent.generalEquipmentItem.checklistDataSource.code)}" />

                                                </p:selectOneMenu>

                                            </ui:repeat>
                                        </p:column>
                                    </ui:repeat>
                                </p:row>
                            </ui:repeat>
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="12" style="text-align: center; padding: 1rem; background: var(--gold-50);">
                                        <i class="pi pi-info-circle" style="margin-right: 8px; color: var(--gold-600);"></i>
                                        End of Inspection Details
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </div>
                </div>

                <!-- مؤشر التمرير -->
                <div class="scroll-indicator">
                    <i class="pi pi-arrow-left"></i>
                    Scroll horizontally to view all content
                    <i class="pi pi-arrow-right"></i>
                </div>
            </div>

            <p:divider layout="horizontal" type="solid" styleClass="mt-4 mb-4" />

            <!-- Review and Actions Section -->
            <div class="card">
                <div class="section-header">
                    <h4 style="color: var(--gold-800); margin: 0; font-family: 'Playfair Display', serif;">
                        <i class="pi pi-check-circle" style="margin-right: 10px;"></i>
                        Approval Process
                    </h4>
                </div>

                <div class="row">
                    <div class="col-12 col-lg-3 col-xl-2 col-xxl-2">
                        <h:outputText value="#{interfaceLabel.reviewerEngineer}"
                                      styleClass="smat-label" rendered="#{!inspectionFormBean.disabled}" />
                    </div>

                    <div class="col-12 col-lg-9 col-xl-10 col-xxl-10">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.reviewerEngineer}"
                                          styleClass="smat-label" rendered="#{!inspectionFormBean.disabled}" />
                            <p:selectOneMenu id="selectoneMenu_UserAliasRecpient" rendered="#{!inspectionFormBean.disabled}"
                                             style="width:100%;" filter="true"
                                             filterMatchMode="contains"
                                             widgetVar="widgetVar_SelectOneMenu"
                                             converter="omnifaces.SelectItemsIndexConverter"
                                             value="#{inspectionFormBean.selectedUserAliasRecipient}"
                                             required="#{!inspectionFormBean.savingDraft}"
                                             requiredMessage="Reviewer engineer is required">
                                <f:selectItem itemLabel="#{interfaceLabel.choose}" itemValue="#{null}" noSelectionOption="true" />
                                <f:selectItems
                                        itemLabel=" ( #{userAlias.userCode} )#{userAlias.sysUserBySysUser.displayName} / #{userAlias.organizationByOrganization.name} / #{userAlias.jobPosition.name}"
                                        itemValue="#{userAlias}" var="userAlias"
                                        value="#{inspectionFormBean.userAliasRecipientList}" />
                            </p:selectOneMenu>
                            <p:message for="selectoneMenu_UserAliasRecpient" display="icon" />
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-12 col-xl-12 col-xxl-12">
                        <div class="field field-required">
                            <h:outputText value="#{interfaceLabel.comment}" styleClass="smat-label" />
                            <p:inputTextarea id="comment" value="#{inspectionFormBean.comment}" rows="3"
                                             styleClass="block" required="#{!inspectionFormBean.savingDraft}"
                                             requiredMessage="Comment is required"
                                             placeholder="Enter your approval comments here..." />
                            <p:message for="comment" display="icon" />
                        </div>
                    </div>
                </div>

                <p:divider type="solid" styleClass="mt-4 mb-4" />

                <div class="row">
                    <div class="#{inspectionFormBean.disabled ? 'col-lg-6 col-xl-6 col-xxl-6' : 'col-lg-12 col-xl-12 col-xxl-12'}">
                        <div class="field">
                            <h:outputLabel value="#{interfaceLabel.inspectionEngineer}"
                                           rendered="#{inspectionFormBean.disabled}"
                                           styleClass="smat-label" />
                            <p:inputText disabled="true"
                                         rendered="#{inspectionFormBean.disabled}"
                                         value="#{inspectionFormBean.equipmentInspectionForm.sysUserByInspectionBy.displayName}"
                                         styleClass="block" style="font-weight:600;color:var(--success-600);font-size: 1rem;" />
                        </div>
                    </div>
                    <div class="#{inspectionFormBean.disabled ? 'col-lg-6 col-xl-6 col-xxl-6' : 'col-lg-12 col-xl-12 col-xxl-12'}">
                        <div class="field">
                            <h:outputLabel
                                    value="#{inspectionFormBean.disabled ? interfaceLabel.reviewerEngineer : interfaceLabel.inspectionEngineer}"
                                    styleClass="smat-label" />
                            <p:inputText disabled="true"
                                         value="#{loginBean.user.displayName}"
                                         styleClass="block" style="font-weight:600;color:var(--success-600);font-size: 1rem;" />
                        </div>
                    </div>
                </div>

                <div class="action-buttons-compact">
                    <!-- Save/Done Button - Golden Primary -->
                    <p:commandButton id="commandButton_save"
                                     value="#{inspectionFormBean.disabled ? 'Approve' : interfaceLabel.save}"
                                     icon="#{inspectionFormBean.disabled ? 'pi pi-check-circle' : 'pi pi-save'}"
                                     pt:data-tooltip="#{inspectionFormBean.disabled ? 'Done' : interfaceLabel.save}"
                                     process="@form" action="#{inspectionFormBean.doSave()}"
                                     update="@form" disabled="#{inspectionFormBean.step.equals('03')}"
                                     styleClass="btn-golden-primary rounded-btn" />

                    <!-- Return Button - Golden Orange -->
                    <p:commandButton id="commandButton_return"
                                     value="#{interfaceLabel.returnToInspector}"
                                     disabled="#{inspectionFormBean.step.equals('03')}"
                                     icon="pi pi-file-edit" rendered="#{inspectionFormBean.disabled}"
                                     pt:data-tooltip="#{interfaceLabel.returnToInspector}"
                                     process="@form" update="@([id$=messages])"
                                     action="#{inspectionFormBean.returnToInspector()}"
                                     styleClass="btn-golden-orange rounded-btn" />

                    <!-- Print Button - Golden Blue -->
                    <p:commandButton id="commandButton_print"
                                     rendered="#{inspectionFormBean.step.equals('03')}"
                                     action="#{inspectionFormBean.doPrint()}"
                                     value="#{interfaceLabel.print}" icon="pi pi-print"
                                     pt:data-tooltip="#{interfaceLabel.print}"
                                     styleClass="btn-golden-blue rounded-btn"
                                     onstart="PF('statusDialog').show();"
                                     oncomplete="PF('statusDialog').hide();" />

                    <!-- Cancel Button - Golden Red -->
                    <p:button id="commandButton_cancel"
                              value="Return"
                              icon="pi pi-times"
                              pt:data-tooltip="Return"
                              styleClass="btn-golden-red rounded-btn"
                              outcome="pretty:inspection/my-tasks" />
                </div>
            </div>
        </h:form>
    </ui:define>

    <ui:define name="section-dialogs">
        <!-- Premium Status Dialog -->
        <p:dialog modal="true" widgetVar="statusDialog"
                  header="#{interfaceLabel.processing}" draggable="false"
                  closable="false" resizable="false" styleClass="glass-dialog">
            <div style="text-align: center; padding: 2.5rem;">
                <i class="pi pi-spinner pi-spin" style="font-size: 3.5rem; color: var(--gold-500);"></i>
                <p style="margin-top: 1.75rem; color: var(--text-primary); font-weight: 600; font-size: 1.1rem;">Processing your request...</p>
                <p style="color: var(--text-secondary); font-size: 0.9rem;">Please wait while we complete your action</p>
            </div>
        </p:dialog>

        <!-- Premium Document Viewer Dialog -->
        <p:dialog header="#{interfaceLabel.viewer}" widgetVar="viewerWidgetVar"
                  modal="true" responsive="true" width="90%" height="90%"
                  showEffect="fade" hideEffect="fade" closable="true"
                  draggable="true" resizable="true" maximizable="true"
                  styleClass="max-w-screen">
            <h:form id="form_viewer">
                <p:outputPanel id="manage-viewer-content" style="width:100%;height:100%">
                    <pe:documentViewer id="documentViewer_pdf" height="100%"
                                       zoom="page-width" rendered="true"
                                       value="#{certificateViewerBean.file}" />
                </p:outputPanel>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>