<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

    <ui:define name="section-head">
        #{interfaceLabel.view} #{interfaceLabel.equipmentCategory}
    </ui:define>

    <ui:define name="head">
        <h:outputStylesheet library="#{appSetting.resourceLib}"
                            name="css/material-theme.css"></h:outputStylesheet>
        <style>
            .english-name-column {
                min-width: 200px;
                max-width: 300px;
                word-wrap: break-word;
                white-space: normal !important;
            }
            @media screen and (max-width: 768px) {
                .english-name-column {
                    min-width: 150px;
                    max-width: 200px;
                }
            }

            /* Improved styling for disabled rows */
            .equip-disabled-row {
                background-color: #f8f9fa !important;
                color: #6c757d !important;
                position: relative;
            }

            .equip-disabled-row::after {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(135deg, rgba(108,117,125,0.1) 0%, rgba(108,117,125,0.05) 100%);
                pointer-events: none;
            }

            .equip-disabled-row .ui-button {
                opacity: 0.8;
                transform: scale(0.95);
            }

            /* Improved toggle button styling */
            .toggle-btn {
                min-width: 100px;
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
                border-radius: 20px;
                transition: all 0.3s ease;
                border: none;
                font-weight: 500;
            }

            .toggle-btn-enabled {
                background: linear-gradient(135deg, #28a745 0%, #20c997 100%) !important;
                color: white !important;
            }

            .toggle-btn-enabled:hover {
                background: linear-gradient(135deg, #218838 0%, #1e9e8a 100%) !important;
                transform: translateY(-1px);
                box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
            }

            .toggle-btn-disabled {
                background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%) !important;
                color: white !important;
            }

            .toggle-btn-disabled:hover {
                background: linear-gradient(135deg, #c82333 0%, #d91a7a 100%) !important;
                transform: translateY(-1px);
                box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
            }

            .toggle-btn:active {
                transform: translateY(0);
            }

            .status-badge {
                display: inline-block;
                padding: 0.25rem 0.6rem;
                border-radius: 12px;
                font-size: 0.75rem;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .status-active {
                background-color: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }

            .status-inactive {
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
            }

            /* Enhanced column styling */
            .status-column {
                text-align: center;
                width: 140px;
            }

            .action-column {
                width: 120px;
                text-align: center;
            }
        </style>
    </ui:define>

    <ui:define name="section-content">
        <h:form id="form">
            <div class="card">
                <p:growl id="messages" showDetail="true" />
                <div class="row">
                    <div class="col-lg-9 col-xl-8 col-xxl-7">
                        <p:commandButton value="#{interfaceLabel.add}" icon="pi pi-plus"
                                         actionListener="#{codingEquipmentCategoryBean.openNew}"
                                         update=":form:outputPanel-content"
                                         oncomplete="PF('widgetVarDetailDialog').show()"
                                         styleClass="rounded-button ui-button-success ui-button-raised ui-button-flat"
                                         style="#{app.locale.locale eq 'en'? 'margin-right:.5rem' : 'margin-left:.5rem'} ">
                            <p:resetInput target=":form:outputPanel-content" />
                        </p:commandButton>

                        <p:commandButton id="delete-equipmentCategory-button"
                                         value="#{codingEquipmentCategoryBean.deleteButtonMessage}"
                                         icon="pi pi-trash" styleClass="rounded-button ui-button-danger ui-button-raised ui-button-flat"
                                         actionListener="#{codingEquipmentCategoryBean.deleteSelectedEquipmentCategory}"
                                         disabled="#{!codingEquipmentCategoryBean.hasSelectedEquipmentCategory()}"
                                         update="@this">
                            <p:confirm header="#{interfaceLabel.confirmation}"
                                       message="#{interfaceLabel.deleteSelectedEquipmentCategory}"
                                       icon="pi pi-exclamation-triangle" />
                        </p:commandButton>
                    </div>
                </div>

                <p:divider layout="horizontal" type="dashed"></p:divider>

                <p:dataTable id="dataTable-equipmentCategory" widgetVar="widgetVarEquipmentCategory"
                             var="equipmentCategory" globalFilterOnly="true"
                             value="#{codingEquipmentCategoryBean.equipmentCategoryList}" reflow="true"
                             styleClass="products-table"
                             selection="#{codingEquipmentCategoryBean.selectedEquipmentCategoryList}"
                             rowKey="#{equipmentCategory.id}" paginator="true" rows="10"
                             rowSelectMode="add" emptyMessage="#{interfaceLabel.noRecordsFound}"
                             paginatorPosition="bottom"
                             rowStyleClass="#{equipmentCategory.disabled ? 'equip-disabled-row' : ''}">

                    <p:ajax event="rowSelect" update=":form:delete-equipmentCategory-button" />
                    <p:ajax event="rowUnselect" update=":form:delete-equipmentCategory-button" />
                    <p:ajax event="rowSelectCheckbox" update=":form:delete-equipmentCategory-button" />
                    <p:ajax event="rowUnselectCheckbox" update=":form:delete-equipmentCategory-button" />
                    <p:ajax event="toggleSelect" update=":form:delete-equipmentCategory-button" />

                    <f:facet name="header">
                        <div class="flex align-items-center justify-content-between">
                            <h:outputText value="#{interfaceLabel.search} : " />
                            <p:inputText id="globalFilter"
                                         onkeyup="PF('widgetVarEquipmentCategory').filter()"
                                         style="width:auto;" placeholder="#{interfaceLabel.enterKeyword}" />
                        </div>
                    </f:facet>

                    <p:column selectionMode="multiple" exportable="false" style="width:40px"></p:column>

                    <p:column headerText="#{interfaceLabel.englishName}"
                              sortBy="#{equipmentCategory.englishName}"
                              filterBy="#{equipmentCategory.englishName}"
                              styleClass="english-name-column">
                        <h:outputText value="#{equipmentCategory.englishName}" />
                    </p:column>

                    <p:column headerText="#{interfaceLabel.code}"
                              sortBy="#{equipmentCategory.code}" filterBy="#{equipmentCategory.code}">
                        <h:outputText value="#{equipmentCategory.code}" />
                    </p:column>

                    <!-- Enhanced status column -->
                    <p:column headerText="#{interfaceLabel.status}" styleClass="status-column">
                        <span class="status-badge #{equipmentCategory.disabled ? 'status-inactive' : 'status-active'}">
                            #{equipmentCategory.disabled ? interfaceLabel.inactive : interfaceLabel.active}
                        </span>
                    </p:column>

                    <!-- Enhanced toggle button column -->
                    <p:column headerText="#{interfaceLabel.actions}" styleClass="action-column">
                        <p:commandButton
                                value="#{equipmentCategory.disabled ? interfaceLabel.enable : interfaceLabel.disable}"
                                icon="#{equipmentCategory.disabled ? 'pi pi-check-circle' : 'pi pi-ban'}"
                                action="#{codingEquipmentCategoryBean.toggleDisabled(equipmentCategory)}"
                                process="@this"
                                update=":form:dataTable-equipmentCategory :form:messages"
                                styleClass="toggle-btn #{equipmentCategory.disabled ? 'toggle-btn-enabled' : 'toggle-btn-disabled'}" />
                    </p:column>

                    <p:column exportable="false" width="60" style="text-align: center;">
                        <p:commandButton icon="pi pi-pencil" styleClass="ui-button-rounded ui-button-info"
                                         update=":form:outputPanel-content"
                                         oncomplete="PF('widgetVarDetailDialog').show()" process="@this">
                            <f:setPropertyActionListener value="#{equipmentCategory}"
                                                         target="#{codingEquipmentCategoryBean.equipmentCategory}" />
                            <p:resetInput target=":form:outputPanel-content" />
                        </p:commandButton>
                    </p:column>

                    <p:column exportable="false" width="60" style="text-align: center;">
                        <p:commandButton styleClass="ui-button-rounded ui-button-danger" icon="pi pi-trash"
                                         process="@this" oncomplete="PF('widgetVarDeleteDialog').show()">
                            <f:setPropertyActionListener value="#{equipmentCategory}"
                                                         target="#{codingEquipmentCategoryBean.equipmentCategory}" />
                        </p:commandButton>
                    </p:column>

                </p:dataTable>

                <p:dialog
                        header="#{interfaceLabel.details} #{interfaceLabel.equipmentCategory}"
                        showEffect="fade" modal="true" widgetVar="widgetVarDetailDialog"
                        responsive="true">
                    <p:outputPanel id="outputPanel-content" class="ui-fluid">
                        <p:outputPanel rendered="#{not empty codingEquipmentCategoryBean.equipmentCategory}">
                            <div class="p-field">
                                <p:outputLabel for="arabicName">#{interfaceLabel.arabicName}</p:outputLabel>
                                <p:inputText id="arabicName"
                                             value="#{codingEquipmentCategoryBean.equipmentCategory.arabicName}"
                                             required="true"
                                             requiredMessage="#{interfaceLabel.arabicName}  #{errorLabel.validateInput}" />
                            </div>
                            <div class="p-field">
                                <p:outputLabel for="englishName">#{interfaceLabel.englishName}</p:outputLabel>
                                <p:inputText id="englishName"
                                             value="#{codingEquipmentCategoryBean.equipmentCategory.englishName}" />
                            </div>
                            <div class="p-field">
                                <p:outputLabel for="code">#{interfaceLabel.code}</p:outputLabel>
                                <p:inputText id="code"
                                             value="#{codingEquipmentCategoryBean.equipmentCategory.code}" />
                            </div>

                        </p:outputPanel>
                    </p:outputPanel>
                    <f:facet name="footer">
                        <p:commandButton value="#{interfaceLabel.save}" icon="pi pi-check"
                                         actionListener="#{codingEquipmentCategoryBean.save}"
                                         update=":form:outputPanel-content :form:dataTable-equipmentCategory"
                                         process="outputPanel-content @this" />
                        <p:commandButton value="#{interfaceLabel.cancel}"
                                         icon="pi pi-times" onclick="PF('widgetVarDetailDialog').hide()"
                                         class="ui-button-secondary" />
                    </f:facet>
                </p:dialog>

                <p:confirmDialog widgetVar="widgetVarDeleteDialog" showEffect="fade"
                                 width="300" message="#{interfaceLabel.deleteSelectedEquipmentCategory}"
                                 header="#{interfaceLabel.confirmation}" severity="warn">
                    <p:commandButton value="#{interfaceLabel.yes}" icon="pi pi-check"
                                     actionListener="#{codingEquipmentCategoryBean.deleteEquipmentCategory}"
                                     process="@this" oncomplete="PF('widgetVarDeleteDialog').hide()" />
                    <p:commandButton value="#{interfaceLabel.no}" type="button"
                                     styleClass="ui-button-secondary" icon="pi pi-times"
                                     onclick="PF('widgetVarDeleteDialog').hide()" />
                </p:confirmDialog>

                <p:confirmDialog global="true" showEffect="fade" width="300">
                    <p:commandButton value="#{interfaceLabel.yes}" type="button"
                                     styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
                    <p:commandButton value="#{interfaceLabel.no}" type="button"
                                     styleClass="ui-confirmdialog-no ui-button-secondary"
                                     icon="pi pi-times" />
                </p:confirmDialog>

            </div>
        </h:form>
    </ui:define>
</ui:composition>