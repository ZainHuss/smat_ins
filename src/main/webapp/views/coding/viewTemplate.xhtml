<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

	<ui:define name="section-head">
        #{interfaceLabel.viewTemplates}
	</ui:define>

	<ui:define name="head">
		<h:outputStylesheet library="#{appSetting.resourceLib}"
			name="css/material-theme.css"></h:outputStylesheet>
		<style>
			.wrap-text {
				white-space: normal !important;
				word-wrap: break-word;
			}
			.column-title {
				width: 25%;
			}
			.column-description {
				width: 30%;
			}
			.column-actions {
				width: 15%;
			}
		</style>
	</ui:define>
	<ui:define name="section-content">
		<h:form id="form">
			<div class="card">
				<p:growl id="messages" showDetail="true" showSummary="false" />
				<div class="row">
					<div class="col-lg-9 col-xl-8 col-xxl-7">
						<p:commandButton value="#{interfaceLabel.add}" icon="pi pi-plus"
							action="pretty:addTemplate"
							styleClass="rounded-button ui-button-success ui-button-raised ui-button-flat"
							style="#{app.locale.locale eq 'en'? 'margin-right:.5rem' : 'margin-left:.5rem'} ">

						</p:commandButton>

					</div>
				</div>

				<p:divider layout="horizontal" type="dashed"></p:divider>

				<p:dataTable id="dataTable" widgetVar="widgetVarDataTable"
					var="formTemplateVar" globalFilterOnly="true"
					value="#{templateDesignBean.formTemplates}" reflow="true"
					styleClass="products-table" rowKey="#{formTemplateVar.id}"
					paginator="true" rows="10"
					emptyMessage="#{interfaceLabel.noRecordsFound}"
					paginatorPosition="bottom">

					<f:facet name="header">
						<div class="flex align-items-center justify-content-between">
							<h:outputText value="#{interfaceLabel.search} : " />
							<p:inputText id="globalFilter"
								onkeyup="PF('widgetVarDataTable').filter()" style="width:auto;"
								placeholder="#{interfaceLabel.enterKeyword}" />
						</div>
					</f:facet>

					<p:column headerText="#{interfaceLabelAnas.title}"
						sortBy="#{formTemplateVar.title}"
						filterBy="#{formTemplateVar.title}"
						styleClass="column-title">
						<h:outputText value="#{formTemplateVar.title}" styleClass="wrap-text"/>
					</p:column>
					<p:column headerText="#{interfaceLabelAnas.description}"
						sortBy="#{formTemplateVar.description}"
						filterBy="#{formTemplateVar.description}"
						styleClass="column-description">
						<h:outputText value="#{formTemplateVar.description}" styleClass="wrap-text"/>
					</p:column>
					<p:column styleClass="column-actions">
						<p:commandButton value="#{interfaceLabel.view}" icon="pi pi-eye"
							actionListener="#{templateDesignBean.assignFormId(formTemplateVar)}"
							styleClass="rounded-button ui-button-info"
							action="pretty:addTemplate"></p:commandButton>
					</p:column>
					<p:column styleClass="column-actions">
						<p:commandButton value="#{interfaceLabel.copyTemplate}"
						    action="#{templateDesignBean.copyTemplate(formTemplateVar)}"
							oncomplete="PF('manageCopyTemplateDialog').show();"
							update="@([id$=manage-copy_template-content])" icon="pi pi-copy"
							styleClass="rounded-button ui-button-warning" />
					</p:column>
					<p:column styleClass="column-actions">
						<p:commandButton value="#{interfaceLabel.delete}"
							action="#{templateDesignBean.deleteTemplate(formTemplateVar)}"
							update="@([id$=dataTable],[id$=messages])" icon="pi pi-trash"
							styleClass="rounded-button ui-button-danger" />
					</p:column>

				</p:dataTable>

			</div>
		</h:form>
	</ui:define>
	<ui:define name="section-dialogs">
		<p:dialog header="#{interfaceLabel.copyTemplate}" showEffect="fade"
			widgetVar="manageCopyTemplateDialog" closable="true"
			blockScroll="true" dynamic="true" cache="true" fitViewport="75%"
			showHeader="true" responsive="true" width="45%" maximizable="true"
			minimizable="true">
			<h:form id="form_copy_template">
				<p:divider layout="horizontal" type="dashed" align="center"></p:divider>
				<p:outputPanel id="manage-copy_template-content" class="ui-fluid"
					layout="inline" style="width:100%;height:75%">
					<p:scrollPanel
						style="border:dashed;border-color:#B9CEF2;width: auto; max-height: 500px;height:auto;"
						mode="native">
						<p:panelGrid columns="2" layout="grid"
							columnClasses="ui-g-12 ui-md-6 ui-lg-4,ui-g-12 ui-md-6 ui-lg-8"
							contentStyleClass="align-items-baseline ui-fluid"
							style="border:0px none; background-color:transparent;">
							<p:column style="background-color: #ededede8;">
								<p:outputLabel value="#{interfaceLabel.equipmentCategory}" />
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:selectOneMenu id="select_equipment_cat"
									disabled="#{templateDesignBean.isLocked}"
									value="#{templateDesignBean.copyTemplate.equipmentCategory}"
									style="color:black;font-weight:bolder;font-style:italic;"
									converter="omnifaces.SelectItemsIndexConverter">
									<f:selectItem itemLabel="#{interfaceLabel.choose}"
										itemValue="#{null}" noSelectionOption="true" />
									<f:selectItems itemLabel=" #{equipmentCategoryVar.name}"
										itemValue="#{equipmentCategoryVar}" var="equipmentCategoryVar"
										value="#{templateDesignBean.equipmentCategories}" />
									<p:ajax event="change"
										listener="#{templateDesignBean.applyCopyPrefix()}"
										update="@([id$=input_prefix],[id$=select_equipment_cat],[id$=messages])"></p:ajax>
								</p:selectOneMenu>
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:outputLabel value="#{interfaceLabel.title} :" />
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:inputText value="#{templateDesignBean.copyTemplate.title}"
									disabled="#{templateDesignBean.isLocked}"
									style="font-weight: bold;"></p:inputText>
							</p:column>

							<p:column style="background-color: #ededede8;">
								<p:outputLabel value="#{interfaceLabel.description} :" />
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:inputText
									value="#{templateDesignBean.copyTemplate.description}"
									disabled="#{templateDesignBean.isLocked}"
									style="font-weight: bold;"></p:inputText>
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:outputLabel value="#{interfaceLabel.code} :" />
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:inputText value="#{templateDesignBean.copyTemplate.code}"
									disabled="true" style="font-weight: bold"></p:inputText>
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:outputLabel value="#{interfaceLabel.prefixCode} :" />
							</p:column>
							<p:column style="background-color: #ededede8;">
								<p:inputText id="input_prefix" disabled="true"
									value="#{templateDesignBean.copyTemplate.prefix}"
									style="font-weight: bold;"></p:inputText>
							</p:column>
						</p:panelGrid>
					</p:scrollPanel>
					<p:divider type="dashed"></p:divider>
					<p:panelGrid columns="2" layout="flex"
						columnClasses="col-2 md:col-2 xl:col-2, col-2 md:col-2 xl:col-2"
						contentStyleClass="align-items-baseline ui-fluid"
						style="border:0px none; background-color:transparent;">
						<p:commandButton value="#{interfaceLabel.save}" icon="pi pi-save"
							action="#{templateDesignBean.doSaveCopyTemplate()}" ajax="true"
							update="@([id$=dataTable],[id$=growl])"
							oncomplete="PF('manageCopyTemplateDialog').hide();"
							styleClass="rounded-button ui-button-primary ui-button-raised ui-button-flat" />

						<p:commandButton value="#{interfaceLabel.close}" ajax="true"
							process="@this"
							styleClass="rounded-button ui-button-danger ui-button-raised ui-button-flat"
							onclick="PF('manageCopyTemplateDialog').hide();" icon="pi pi-times-circle" />

					</p:panelGrid>
				</p:outputPanel>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>